<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Jay播放器</title>
    <style>
        li {
            display: inline-block;
            width: 120px;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
            margin-right: 14px;
        }
        .album {
            font-weight: 700;
        }
        .album::before {
            content: '《';
        }
        .album::after {
            content: '》';
        }
    </style>
</head>
<body>
<script type="text/javascript">
    let album = [
        "八度空间",
        "范特西",
        "惊叹号",
        "跨时代",
        "魔杰座",
        "七里香",
        "十二新作",
        "十一月的萧邦",
        "我很忙",
        "叶惠美",
        "依然范特西",
        "Jay"
    ]
    let listMap = [
        [
            "周杰伦 - 暗号.mp3",
            "周杰伦 - 半岛铁盒.mp3",
            "周杰伦 - 半兽人.mp3",
            "周杰伦 - 分裂.mp3",
            "周杰伦 - 回到过去.mp3",
            "周杰伦 - 火车叨位去.mp3",
            "周杰伦 - 龙拳.mp3",
            "周杰伦 - 米兰的小铁匠.mp3",
            "周杰伦 - 爷爷泡的茶.mp3",
            "周杰伦 - 最后的战役.mp3"
        ],
        [
            "周杰伦 - 爱在西元前.mp3",
            "周杰伦 - 安静.mp3",
            "周杰伦 - 爸,我回来了.mp3",
            "周杰伦 - 对不起(统一茶饮料广告曲).mp3",
            "周杰伦 - 简单爱.mp3",
            "周杰伦 - 开不了口.mp3",
            "周杰伦 - 忍者.mp3",
            "周杰伦 - 上海一九四三.mp3",
            "周杰伦 - 双截棍.mp3",
            "周杰伦 - 威廉古堡.mp3"
        ],
        [
            "周杰伦 - 超跑女神.mp3",
            "周杰伦 - 公主病.mp3",
            "周杰伦 - 惊叹号.mp3",
            "周杰伦 - 疗伤烧肉粽.mp3",
            "周杰伦 - 迷魂曲.mp3",
            "周杰伦 - 你好吗.mp3",
            "周杰伦 - 皮影戏.mp3",
            "周杰伦 - 琴伤.mp3",
            "周杰伦 - 世界未末日.mp3",
            "周杰伦 - 水手怕水.mp3",
            "周杰伦 - Mine Mine.mp3"
        ],
        [
            "周杰伦 - 爱的飞行日记.mp3",
            "周杰伦 - 超人不会飞.mp3",
            "周杰伦 - 好久不见.mp3",
            "周杰伦 - 跨时代.mp3",
            "周杰伦 - 免费教学录影带.mp3",
            "周杰伦 - 说了再见.mp3",
            "周杰伦 - 我落泪情绪零碎.mp3",
            "周杰伦 - 嘻哈空姐.mp3",
            "周杰伦 - 烟花易冷.mp3",
            "周杰伦 - 雨下一整晚.mp3",
            "周杰伦 - 自导自演.mp3"
        ],
        [
            "周杰伦 - 稻香.mp3",
            "周杰伦 - 给我一首歌的时间.mp3",
            "周杰伦 - 花海.mp3",
            "周杰伦 - 兰亭序.mp3",
            "周杰伦 - 流浪诗人.mp3",
            "周杰伦 - 龙战骑士.mp3",
            "周杰伦 - 魔术先生.mp3",
            "周杰伦 - 乔克叔叔.mp3",
            "周杰伦 - 蛇舞.mp3",
            "周杰伦 - 时光机.mp3",
            "周杰伦 - 说好的幸福呢.mp3"
        ],
        [
            "周杰伦 - 搁浅.mp3",
            "周杰伦 - 将军.mp3",
            "周杰伦 - 借口.mp3",
            "周杰伦 - 困兽之斗.mp3",
            "周杰伦 - 乱舞春秋.mp3",
            "周杰伦 - 七里香.mp3",
            "周杰伦 - 外婆.mp3",
            "周杰伦 - 我的地盘.mp3",
            "周杰伦 - 园游会.mp3",
            "周杰伦 - 止战之殇.mp3"
        ],
        [
            "周杰伦 - 爱你没差.mp3",
            "周杰伦 - 比较大的大提琴(feat. 梁心颐 & 杨瑞代).mp3",
            "周杰伦 - 大笨钟.mp3",
            "周杰伦 - 公公偏头痛.mp3",
            "周杰伦 - 红尘客栈.mp3",
            "周杰伦 - 梦想启动.mp3",
            "周杰伦 - 明明就.mp3",
            "周杰伦 - 哪里都是你.mp3",
            "周杰伦 - 傻笑 (feat. 袁咏琳).mp3",
            "周杰伦 - 手语.mp3",
            "周杰伦 - 四季列车.mp3",
            "周杰伦 - 乌克丽丽.mp3"
        ],
        [
            "周杰伦 - 发如雪.mp3",
            "周杰伦 - 枫.mp3",
            "周杰伦 - 黑色毛衣.mp3",
            "周杰伦 - 蓝色风暴.mp3",
            "周杰伦 - 浪漫手机.mp3",
            "周杰伦 - 麦芽糖.mp3",
            "周杰伦 - 逆鳞.mp3",
            "周杰伦 - 漂移.mp3",
            "周杰伦 - 珊瑚海.mp3",
            "周杰伦 - 四面楚歌.mp3",
            "周杰伦 - 夜曲.mp3",
            "周杰伦 - 一路向北(头文字D 电影插曲).mp3"
        ],
        [
            "周杰伦 - 彩虹(命运呼叫转移插曲).mp3",
            "周杰伦 - 扯.mp3",
            "周杰伦 - 牛仔很忙.mp3",
            "周杰伦 - 蒲公英的约定.mp3",
            "周杰伦 - 青花瓷.mp3",
            "周杰伦 - 甜甜的.mp3",
            "周杰伦 - 我不配.mp3",
            "周杰伦 - 无双.mp3",
            "周杰伦 - 阳光宅男.mp3",
            "周杰伦 - 最长的电影.mp3"
        ],
        [
            "周杰伦 - 爱情悬崖.mp3",
            "周杰伦 - 东风破.mp3",
            "周杰伦 - 你听得到.mp3",
            "周杰伦 - 懦夫.mp3",
            "周杰伦 - 晴天.mp3",
            "周杰伦 - 三年二班.mp3",
            "周杰伦 - 双刀.mp3",
            "周杰伦 - 她的睫毛.mp3",
            "周杰伦 - 梯田.mp3",
            "周杰伦 - 同一种调调.mp3",
            "周杰伦 - 以父之名.mp3"
        ],
        [
            "周杰伦 - 白色风车.mp3",
            "周杰伦 - 本草纲目.mp3",
            "周杰伦 - 红模仿.mp3",
            "周杰伦 - 菊花台(《满城尽带黄金甲》片尾曲).mp3",
            "周杰伦 - 迷迭香.mp3",
            "周杰伦 - 千里之外.mp3",
            "周杰伦 - 听妈妈的话.mp3",
            "周杰伦 - 退后.mp3",
            "周杰伦 - 心雨.mp3",
            "周杰伦 - 夜的第七章.mp3"
        ],
        [
            "周杰伦 - 斗牛.mp3",
            "周杰伦 - 反方向的钟.mp3",
            "周杰伦 - 黑色幽默.mp3",
            "周杰伦 - 可爱女人.mp3",
            "周杰伦 - 龙卷风.mp3",
            "周杰伦 - 娘子.mp3",
            "周杰伦 - 完美主义.mp3",
            "周杰伦 - 星晴.mp3",
            "周杰伦 - 伊斯坦堡.mp3",
            "周杰伦 - 印第安老斑鸠.mp3"
        ]
    ]

    let count = 0; //一共多少MP3文件
    listMap.forEach(item => {
        count += item.length
    })
    let albumRandomIdx = parseInt(Math.random()*12)
    let index = `http://localhost:8000/${album[albumRandomIdx]}/${listMap[albumRandomIdx][parseInt(Math.random()*listMap[albumRandomIdx].length)]}`; // 初始化播放那个文件
    console.log(index);
    window.onload = function(){
        let audio = new Audio();
        audio.controls = true;
        audio.loop = false;
        audio.preload = 'auto;'
        audio.src = index;
        let start = document.createElement('div')
        start.innerText= '随机播放开始'
        document.body.appendChild(start);
        document.body.appendChild(audio);
        start.addEventListener('click', () => {
            audio.play();
        })
        audio.addEventListener('ended', playEndedHandler, false);

        function playEndedHandler(){
            let idx_ = parseInt(Math.random()*12)
            console.log(listMap[idx_].length, Math.random() * listMap[idx_].length);
            let url = `http://localhost:8000/${album[idx_]}/${listMap[idx_][parseInt(Math.random()*listMap[idx_].length)]}`; // 初始化播放那个文件
            audio.src = url;
            audio.play();
        }

        let div = document.createElement('div');
        album.forEach((item, index) => {
            let nameDiv = document.createElement('div');
            nameDiv.innerText = item
            nameDiv.className = 'album'
            div.appendChild(nameDiv);
            let ul = document.createElement('ul');
            listMap[index].forEach((song, songIdx)=> {
                let li = document.createElement('li')
                li.title = song
                li.albumIdx = index
                li.songIdx = songIdx
                let text = document.createTextNode(song.slice(6, -4));
                li.appendChild(text);
                ul.appendChild(li);
                li.addEventListener('click',function(event){
                    console.dir(event.target);
                    console.log(album[event.target.albumIdx]);
                    console.log(listMap[event.target.songIdx]);
                    const {albumIdx, songIdx} = event.target
                    audio.src = `http://localhost:8000/${album[albumIdx]}/${listMap[albumIdx][songIdx]}`;
                    console.dir(audio);
                    audio.play();
                },false)

            })
            div.appendChild(ul);
        })
        document.body.appendChild(div);
    }
</script>
</body>
</html>
